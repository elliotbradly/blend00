モーションツールキット -Setting-

【プラグイン名】MotionToolKitS
【ver.】0.1

【作者】ひげにんじん

動作確認 PMXE
Ver.0.2.1.9

****************************************************************


このツールは、モーションを作りやすくすることを目的とした
モデル変更機能を詰め込んでいます。

こんなようなことを試したい方におすすめします。

　・配布モーションを今よりラクに作りたい
　・別に配布にはこだわらないが、単純にラクしたい
　・自分こだわりの表示枠があって、新しいモデルを使うときに一括設定したい


■インストールの仕方

　PMX Editorプラグインです。
　お手持ちのPMX Editorを開いて、以下の場所に
　「MotionToolKitS.dll」および「MotionToolKit」フォルダをコピーしたら完了です。

○置き場所
PmxEditor_XXXX\_plugin\User

■使い方

　●事前準備
　　１．モーションを作りたいモデルを用意し、別名保存しておきます。

　●使い方
　　１．PMXeを起動します。

　　２．１の躍らせたいモデルをPMXeで読み込みます。

　　３．[編集]->[プラグイン]->[User]->[モーションツールキット -Setting-]を選択します。

　　４．変更したい操作を適宜やります

　　５．モデルを保存します。

　※元のモデルは必ず残してくださいね。


■機能一覧
　１．ボーン追加
　　モデルにモーション作成用便利ボーンを追加します。

　２．ガイドエフェクト作成
　　モーション作成支援用のエフェクトを生成します。

　３．表示枠一括変更
　　モデルの表示枠を一括設定します。

　４．ボーン情報
　　ボーンを階層構造で確認／編集します。

■機能詳細

　１．ボーン追加
　　[ボーン追加]ボタンをポチれば、以下チェック済みのボーンをモデルに追加します。

　　▼等比連動ボーン
　　　・センター回転時、頭の向きを固定する
　　　　　MMDでShift選択で、[センター]+[頭中心]ボーンと選んで回転した場合に、頭の向きを固定にする多段ボーンを追加します。
　　　　　頭を中心にセンターを回転する方法でモーションを作成するときに便利です。

　　　　【習うより慣れる】
　　　　　MMDで、「センター」＋「頭中心」をShiftキー押しながら選択して、Shift+Xキーで回転ハンドルを出して回転してみる。
　　　　　頭を中心に、姿勢がグリグリ変わって、面白い。

　　　・首ボーンは極力つけたくない
　　　　　頭を動かせば、一定比率で首も自動的に連動する多段ボーンを追加します。
　　　　　頭を回転した回転量を、頭と首で分散するため、この多段構造をもたないモデルともモーションの互換性があります。

　　　　【習うより慣れる】
　　　　　頭を動かすと、首も連動しているので、首付けなくても「っぽく」なる。

　　　・肩ボーンは極力つけたくない
　　　　　腕を動かせば、一定比率で肩も自動的に連動する多段ボーンを追加します。
　　　　　腕を回転した回転量を、腕と肩で分散するため、この多段構造をもたないモデルともモーションの互換性があります。

　　　　【習うより慣れる】
　　　　　腕を動かすと、肩も連動しているので、肩付けなくても「っぽく」なる。

　　　・上半身2ボーンを細工する
　　　　　上半身2を動かせば、一定比率で上半身も自動的に連動する多段ボーンを追加します。
　　　　　上半身2を回転した回転量を、上半身2と上半身で分散するため、この多段構造をもたないモデルともモーションの互換性があります。

　　　　【習うより慣れる】
　　　　　上半身2を動かすと上半身も連動するので、なんとなく上半身2だけでも結構表現力があがる。


　　▼変換補助ボーン
　　　・ｲﾗﾈボーン
　　　　後のConvertプラグインで参照する特殊ボーンです。
　　　　センター回転情報を、Convertプラグインで上半身／下半身に分散する際にこのボーンキーが打たれているかどうかを評価します。
　　　　もし、このボーンのキーフレームが打たれている場合、センター回転情報をゼロ化する際に
　　　　上半身／下半身へのキー登録は行わなくなります。
　　　　まあ、完全にオマケ機能です。


　　▼グローバルロックボーン
　　　・手首lockボーン
　　　　手首の向きを一定期間グローバルで固定したい場合に使います。
　　　　対象期間に対して、lockボーンが連続フレームで打った状態で
　　　　Convertプラグインで、手首lock用VMDを出力すると

　　　　　　手首lockの連続フレームの開始時点の「手首のグローバル」を記憶し、
　　　　　　連続フレーム期間中は同じグローバルとなるように、1F打ちの手首だけのVMDを生成します。
　　　　　　腕IK構造も考慮しますが、手首の「向き」だけを固定にするだけで「位置」は固定になりません。

　　　　【習うより慣れる】
　　　　　とりあえず、手首lockを1F打ち適当にしておけば、後でその区間の手首ボーンのグローバルな向きを固定にできる。


　　　・足首lockボーン
　　　　足首の向きを一定期間グローバルで固定したい場合に使います。
　　　　対象期間に対して、lockボーンが連続フレームで打った状態で
　　　　Convertプラグインで、足首lock用VMDを出力すると

　　　　　　足首lockの連続フレームの開始時点の「足首のグローバル」を記憶し、
　　　　　　連続フレーム期間中は同じグローバルとなるように、1F打ちの足首だけのVMDを生成します。
　　　　　　足IK構造も考慮しますが、足首の「向き」だけを固定にするだけで「位置」は固定になりません。

　　　　【習うより慣れる】
　　　　　とりあえず、足首lockを1F打ち適当にしておけば、後でその区間の足首ボーンのグローバルな向きを固定にできる。


　　▼ガイドエフェクトボーン
　　　・ガイドエフェクトに必要なボーンを追加する。

　　▼Y軸回転固定化
　　　・肘ボーンをY軸回転に固定する。
　　　　人体の構造的に、この制限をかけたほうが自然なモーションとなりやすい。


　２．ガイドエフェクト作成

　　***************************************************
　　※この機能を使う際には、モデルのファイル名を気をつけてください。
　　　実際に踊るモデルのファイルでエフェクト生成しないと、正しく動きません。
　　　作者がよくやるのが、モデルの構造変更して「別名保存せずに」エフェクト生成し、後で別名保存をした結果、
　　　動かねぇじゃん・・・ってパターンです。
　　***************************************************

　　[fx生成]ボタンをポチれば、このモデルに特化したモーション支援用のガイドエフェクトを生成します。
　　エフェクトは、モデルが保存されているフォルダの[guide]フォルダに作成されます。
　　MMD上で、MotionGuide.xを読み込めば、ガイドエフェクトが表示されます。

　　ターゲットのモデル（このエフェクトを作成したときのモデルと同名のファイル名）がいれば、
　　自動的に追尾するようになります。

　　●ガイドエフェクトの内容
　　　以下をみながら、なんとなくやってもらえるとイメージがわくと思います。

　　　１．歩幅ガイド
　　　　　モデルに追従する２重の円です。
　　　　　内側の円が肩幅。外側の円が肩幅の２倍となっています。
　　　　　自然な歩幅＝肩幅とも言うので、基準にするといい感じだと思います。

　　　２．バランスガイド
　　　　　３本の線があります。
　　　　　赤：センターの位置
　　　　　緑：バランスボーンの位置（バランスボーンはSettingで追加するボーンです）
　　　　　青：足IKの位置の中間の位置

　　　　センターの回転を使わない限り、赤と緑の位置は一致します。

　　　　よく、両足を結んだ線上に重心があると姿勢が安定している、などといいますが、
　　　　まさにその辺を目で見れるようにしてみました。


　　　なお、このエフェクトはモデルの構造から肩幅やら何やらを診断しているため、
　　　他のモデルに流用することはオススメしません。
　　　毎回、モデルごとの生成してください。


　３．表示枠一括変更
　　あらかじめ作成済みの変換ルールファイルに反って、表示枠を一括で変更します。
　　プリセットとして、作者の趣味にあわせた表示枠ルールが \MotionToolKitフォルダに保存されています。
　　適宜、自分の趣味に合わせて保存しておくと、
　　　・モデルさんのバージョンアップ時
　　　・複数作者さんのモデルを同時にモーション作成する時
　　などに、簡単に同じ表示枠に変更できるため便利です。

　　変換ルールの編集は、いずれかの方法で行います。
　　　１．[表示枠変換]タブで直接編集した結果を保存する方法
　　　２．[メニュー] -> [表示] -> [表示枠ルールエディタ]から、専用エディタを開く方法


　　モデルに対して編集した変換ルールを適用するには、[表示枠変換]ボタンをポチります。
　　これで、実際のモデルの表示枠が変更されます。

　　※なお、ボーン枠だけを編集します。
　　　モーフ枠は編集できません。


　４．ボーン情報
　　あまり役に立ちませんが、ボーンをツリー構造で表示します。
　　ツリーを見ながらボーンの挿入や削除ができます。
　　地味に便利なのは、このボーンツリーでボーンを選択すると、PMXEditor本体のボーンも選択されます。
　　階層に沿ってボーンを見たいときには、便利かもしれません。



■動作確認環境

　・Windows 7
　・PmxEditor Ver 0.2.1.9
　・PMXファイル限定（PMDは対象外）
　・MMDでのみ確認（MMMは確認しておりません）

■開発環境

Microsoft Visual C# 2010 Express Edition


■免責

本ソフトウェアを利用した結果によるいかなる損害、その他の事柄について
作者はいかなる責任も負いかねます。
自己責任でご利用ください。

　許可事項
　本ソフトウェアを使用する上においては、商用／非商用、有償／無償を問わず制限はありません。
　個人利用やクローズドコミュニティでの改変・修正も自由です。
　（オープンコミュニティでの共有は、下記再配布に当たるため、禁止です）
　また、本ソフトウェア使用に当たっては、特に作者への連絡や著作権の明記などはありません。
　ご自由にお使いください。

　禁止事項
　本ソフトウェアの再配布は禁止とします。
　　１、自由に使っていい反面、過度なサポートは期待しないでほしい
　　２．著作権は放棄していない
　　３．再配布による無用なトラブルは避けたい
　という趣旨なのでご理解ください。
　個別のご相談がありましたら、ご連絡ください。


気づいた点がありましたら、Twitterアカウント @higeninjin までどうぞ。


■解説サイト
http://ch.nicovideo.jp/higeninjin/blomaga/ar873438


＠＠更新履歴

2015/9/16　一般配布

作者　ひげにんじん
